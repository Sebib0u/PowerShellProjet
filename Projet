Enter-PSSession -ComputerName SRVSEB -Credential SEB\Administrator #prise en charge du serveur à distance
Import-Module GroupPolicy # Une fois GPMC installé, vous pouvez charger le module de stratégie de groupe.
Get-Command –Module GroupPolicy # Pour obtenir une liste des applets de commande disponibles dans le module.
Get-GPO -All # M'affiche toutes les GPO de mon serveur.
New-GPO # Créer une GPO.

#Structure de la création de GPO#

    # load required modules
    Import-Module ActiveDirectory
    Import-Module GroupPolicy

    #define variables
    $GPOName       = 'GPO created by PowerShell'
    $defaultNC     = ( [ADSI]"LDAP://RootDSE" ).defaultNamingContext.Value
    #$TargetOU      = 'OU=Serveurs,' + $defaultNC
    $TargetOU      = $defaultNC

    #create new GPO shell
    $GPO = New-GPO -Name $GPOName

    #Pose d'éléments pour modifier des clés de registre par GPO
    Set-GPPrefRegistryValue -Name $GPOName -Action Update -Context Computer -Key 'HKCC\Software\Microsoft\Internet Explorer\Main' -Type DWord  -ValueName 'UseSWRender' -Value 1 | out-null
    Set-GPPrefRegistryValue -Name $GPOName -Action Update -Context Computer -Key 'HKLM\Software\Citrix\Dazzle' -Type String   -ValueName 'AllowAddStore' -Value 'A' | out-null
    Set-GPPrefRegistryValue -Name $GPOName -Action Update -Context Computer -Key 'HKLM\Software\CitrixAuthManager' -Type String   -ValueName 'ConnectionSecurityMode' -Value 'Any' | out-null

    #Pose d'éléments pour modifier des paramètres par GPO
    Set-GPRegistryValue -Name $GPOName -key "HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate\AU" -ValueName AUOptions -Type DWORD -value 2
    Set-GPRegistryValue -Name $GPOName -key "HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate\AU" -ValueName DetectionFrequency -Type DWORD -value 4
    Set-GPRegistryValue -Name $GPOName -key "HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate\AU" -ValueName DetectionFrequencyEnabled -Type DWORD -value 1






#GPO 1 (général : font d'écran)
    $GPOname = 'FontEcran'
    New-GPO -Name $GPOname 
        # A change rpour font d'écran. Voir si possibilité de ne pas passer par la table de registre
         Set-GPPrefRegistryValue -Name $GPOname -Action Update -Context Computer -Key 'HKCC\Software\Microsoft\Internet Explorer\Main' -Type DWord  -ValueName 'UseSWRender' -Value 1 | out-null
        # Permet de linker vers l'OU, a changer le lien "Target"
        Set-GPLink -Name $GPOname -Target "?" -LinkEnabled Yes
Projet
https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn581922(v=ws.11)
https://devblogs.microsoft.com/scripting/hey-scripting-guy-how-can-i-use-group-policy-cmdlets-to-back-up-and-restore-group-policy-objects/
https://learn.microsoft.com/en-us/powershell/module/grouppolicy/set-gplink?view=windowsserver2022-ps
https://learn.microsoft.com/en-us/powershell/module/grouppolicy/new-gpo?view=windowsserver2022-ps